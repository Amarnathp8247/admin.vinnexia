import{y as A,z as F,r as h,k as I,j as e,F as P,E,J as R,T as m,L as B,h as p,bY as N,bZ as V,b_ as W,b$ as $,o as O,aE as U,c as L,a2 as q,b7 as H,a as G,b as Q,c0 as Y,S as C,B as M,I as Z,i as j,av as _,c1 as J,c2 as K,Z as w,c3 as X,ay as ee,aD as te}from"./index-oaA_Ltxz.js";import{M as ae}from"./ModalComponent-DTq5tozF.js";import{S as se}from"./SearchableSelector-B0BDCd1f.js";function ne(t){return A("MuiDialogContentText",t)}F("MuiDialogContentText",["root"]);const oe=t=>{const{classes:n}=t,c=R({root:["root"]},ne,n);return{...n,...c}},re=P(m,{shouldForwardProp:t=>B(t)||t==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(t,n)=>n.root})({}),ie=h.forwardRef(function(n,o){const c=I({props:n,name:"MuiDialogContentText"}),{children:a,className:r,...s}=c,i=oe(s);return e.jsx(re,{component:"p",variant:"body1",color:"textSecondary",ref:o,ownerState:s,className:E(i.root,r),...c,classes:i})});function le({onClick:t,Icon:n,name:o,btnsx:c,description:a="",caution:r=""}){const[s,i]=h.useState(!1),x=()=>{i(!0)},g=()=>{i(!1)},f=()=>{t(),i(!1)};return e.jsxs(h.Fragment,{children:[e.jsx(p,{onClick:x,sx:{...c},variant:"contained",children:o||e.jsx(n,{sx:{fontSize:"1rem"}})}),e.jsxs(N,{open:s,onClose:g,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(V,{id:"alert-dialog-title",children:r}),e.jsx(W,{children:e.jsx(ie,{id:"alert-dialog-description",children:a})}),e.jsxs($,{children:[e.jsx(p,{onClick:g,children:"Cancel"}),e.jsx(p,{onClick:f,autoFocus:!0,color:"error",children:"Confirm Delete"})]})]})]})}const ce=O({marketingMemberId:U({required_error:"Marketing member is required"}).nullable().refine(t=>t!==null,{message:"Marketing member is required"})});function de(){var T;const t=L(),{leadId:n}=q(d=>d.lead),[o,c]=h.useState(""),a={marketingMemberId:null},{data:r,isLoading:s}=H({page:1,sizePerPage:10,search:o},{skip:o.length<3}),i=o.length>=3?((T=r==null?void 0:r.data)==null?void 0:T.usersList)||[]:[],{handleSubmit:x,reset:g,watch:f,setValue:y,formState:{errors:b}}=G({resolver:Q(ce),defaultValues:a}),[S,{isLoading:z}]=Y(),v=async d=>{var D,k;try{const l=await S({...d,leadId:n}).unwrap();l!=null&&l.status&&(t(j({open:!0,message:l==null?void 0:l.message,severity:"success"})),g(a))}catch(l){(D=l==null?void 0:l.data)!=null&&D.status||t(j({open:!0,message:((k=l==null?void 0:l.data)==null?void 0:k.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return e.jsxs(C,{component:"form",onSubmit:x(v),children:[e.jsx(m,{fontWeight:700,fontSize:"1.5rem",mb:"1.5rem",children:"Assign To"}),e.jsxs(M,{children:[e.jsx(Z,{sx:{mb:".5rem"},children:"Select Marketing *"}),e.jsx(se,{width:"100%",items:i.map(d=>({value:d.id,name:`${d.name} (${d.email})`})),value:f("marketingMemberId"),onChange:d=>y("marketingMemberId",d,{shouldValidate:!0}),onSearchChange:d=>c(d),isLoading:s,shouldBeFullwidth:!0}),b.userId&&e.jsx(m,{color:"error",fontSize:"14px",children:b.userId.message})]}),e.jsx(p,{type:"submit",variant:"contained",disabled:z,sx:{textTransform:"capitalize",boxShadow:"none",color:"white",mt:"1.5rem",alignSelf:"self-start","&:hover":{boxShadow:"none"}},children:"Assign"})]})}const ue=[{name:"View",link:t=>`/admin/marketing/leadList/viewLeadDetails/${t}`,type:"button"},{name:"Edit",link:t=>`/admin/marketing/editLead/${t}`,type:"button"},{name:"Delete",type:"button"},{name:"Assign To",type:"modal"},{name:"Convert",type:"button"}],u=_(),me=[u.accessor("id",{header:"ID",size:40}),u.accessor("name",{header:"Name",size:150}),u.accessor("email",{header:"Email",size:40}),u.accessor("mobile",{header:"Mobile",size:200,Cell:({cell:t})=>{const n=t.getValue();return e.jsxs(C,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(m,{variant:"body2",children:n}),e.jsx(p,{sx:{textTransform:"none",color:"white",fontSize:"0.7rem",px:"8px",py:"4px"},variant:"contained",children:"Open"})]})}}),u.accessor("country",{header:"Country",size:100}),u.accessor("source",{header:"Source",size:100}),u.accessor("status",{header:"Status",size:150,Cell:({cell:t})=>{const n=t.getValue(),o=n==="INTRESTED"?"green":"red";return e.jsx(m,{sx:{color:o,fontWeight:"bold",fontSize:"14px"},children:n})}}),u.accessor("description",{header:"Description",size:200}),u.accessor("assignTo",{header:"AssignTo",size:40,Cell:({row:t})=>t.original.assignTo?e.jsx(m,{children:t.original.assignTo}):e.jsx(m,{component:"em",fontSize:"12px",children:"Empty"})}),u.accessor("createdAt",{header:"Registration Date",size:200,Cell:({row:t})=>e.jsx(m,{fontSize:"14px",children:new Date(t.original.createdAt).toLocaleString()})}),u.display({id:"action",header:"Action",Cell:({row:t})=>{const n=L(),[o]=J(),c=async()=>{var a,r;try{const s=await o({leadId:t.original.id,isDeleted:!0}).unwrap();s!=null&&s.status&&n(j({open:!0,message:s==null?void 0:s.message,severity:"success"}))}catch(s){(a=s==null?void 0:s.data)!=null&&a.status||n(j({open:!0,message:((r=s==null?void 0:s.data)==null?void 0:r.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return e.jsx(C,{sx:{flexDirection:"row",gap:"4px",flexWrap:"wrap"},children:ue.map((a,r)=>{const s=a.type==="modal",i=a.name==="Delete",x=a.link,g=typeof a.link=="function"?a.link(t.original.id):a.link;return s?e.jsx(ae,{Content:de,onOpen:()=>n(K(t.original.id)),btnName:a.name,modalWidth:{xs:"95%",sm:600},btnSx:{textTransform:"none",color:"white",fontSize:"0.7rem",px:"8px",py:"4px"}},r):i?e.jsx(le,{onClick:c,name:a.name,btnsx:{textTransform:"none",color:"white",fontSize:"0.7rem",px:"8px",py:"4px"},description:"This action will mark the user as inactive (soft delete). You can restore the user later from the admin panel.",caution:"Are you sure you want to delete this user?"}):x?e.jsx(p,{component:w,to:g,sx:{textTransform:"none",color:"white",fontSize:"0.7rem",px:"8px",py:"4px"},variant:"contained",children:a.name},r):e.jsx(p,{sx:{textTransform:"none",color:"white",fontSize:"0.7rem",px:"8px",py:"4px"},variant:"contained",children:a.name},r)})})},size:250})];function he(){var y,b,S;const[t,n]=h.useState({pageIndex:0,pageSize:10}),[o,c]=h.useState(""),{data:a,isLoading:r,isError:s,error:i}=X({page:t.pageIndex+1,sizePerPage:t.pageSize,search:o}),x=(y=i==null?void 0:i.data)==null?void 0:y.message,g=((b=a==null?void 0:a.data)==null?void 0:b.usersList)||[],f=ee({columns:me,data:g,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,manualPagination:!0,manualFiltering:!0,rowCount:((S=a==null?void 0:a.data)==null?void 0:S.totalRecords)||0,state:{pagination:t,globalFilter:o,isLoading:r,showAlertBanner:s},onPaginationChange:n,onGlobalFilterChange:c,columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiToolbarAlertBannerProps:s?{color:"error",children:x||"Error loading Leads List."}:void 0});return e.jsxs(e.Fragment,{children:[e.jsxs(M,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(m,{variant:"h5",fontWeight:"700",fontSize:"1.8rem",children:"Leads List"}),e.jsx(p,{component:w,to:"/admin/marketing/addLead",sx:{textTransform:"none",color:"white",fontSize:"1rem"},variant:"contained",children:"Add"})]}),e.jsx(C,{sx:{marginTop:"2rem",borderRadius:"1.2rem",overflow:"hidden"},children:e.jsx(te,{table:f})})]})}export{he as default};
