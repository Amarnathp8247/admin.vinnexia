import{bz as n,c as Q,a as R,r as Z,av as _,aI as H,aZ as J,bN as K,bO as X,j as s,T as o,aF as Y,G as a,I as m,aG as T,ap as F,e as ee,h as se,b as te,k as W}from"./index-B_S0l-pH.js";import{S as re}from"./SearchableSelector-C9pLKMko.js";import{C as ie}from"./Card-BbyUSaIa.js";const ne=n.object({userId:n.number({required_error:"User is required"}).nullable().refine(l=>l!==null,{message:"User is required"}),mt5Login:n.string().min(1,"Please select at least one option"),to:n.string().min(1,"Please select at least one option"),type:n.string(),amount:n.coerce.number().positive("Amount must be greater than 0")});function ue(){var S,j,I,y,z;const l=Q(),p={userId:null,mt5Login:"",to:"",type:"2",amount:""},{register:C,handleSubmit:k,reset:B,watch:r,setValue:c,formState:{errors:i}}=R({resolver:te(ne),defaultValues:p}),M=r("mt5Login"),[d,A]=Z.useState(""),{data:x,isLoading:V}=_({page:1,sizePerPage:10,search:d},{skip:d.length<3}),O=d.length>=3?((S=x==null?void 0:x.data)==null?void 0:S.usersList)||[]:[],u=r("userId"),{data:g,isLoading:P}=H({id:u},{skip:!u,refetchOnMountOrArgChange:!0}),{data:h,isLoading:f}=J({id:u},{skip:!u,refetchOnMountOrArgChange:!0}),b=(I=(j=h==null?void 0:h.data)==null?void 0:j.assetData)==null?void 0:I.mainBalance,L=P?[]:(z=(y=g==null?void 0:g.data)==null?void 0:y.filter(e=>(e==null?void 0:e.accountType)=="REAL"))==null?void 0:z.map(e=>e==null?void 0:e.Login),[U,{isLoading:N}]=K(),[$,{isLoading:q}]=X(),E=async e=>{var v,w;const G=(e==null?void 0:e.mt5Login).includes("Wallet"),D={userId:e==null?void 0:e.userId,mt5Login:G?e==null?void 0:e.to:e==null?void 0:e.mt5Login,type:e==null?void 0:e.type,amount:e==null?void 0:e.amount};try{const t=M.includes("Wallet")?await U(D).unwrap():await $(D).unwrap();t!=null&&t.status&&(l(W({open:!0,message:t==null?void 0:t.message,severity:"success"})),B(p))}catch(t){(v=t==null?void 0:t.data)!=null&&v.status||l(W({open:!0,message:((w=t==null?void 0:t.data)==null?void 0:w.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return s.jsxs(s.Fragment,{children:[s.jsx(o,{sx:{fontSize:"2rem",fontWeight:"700"},children:"Internal Transfer"}),s.jsxs(ie,{sx:{boxShadow:"0 0px 0px 0 rgba(0, 0, 0, 0.19), 0 0px 8px 0 rgba(0, 0, 0, 0.19)",borderRadius:"1.2rem",padding:{xs:"1rem",md:"2rem"},mt:"2rem"},component:"form",onSubmit:k(E),children:[s.jsx(o,{mx:{xs:"1rem",md:"0"},children:"Fill Details"}),s.jsx(Y,{sx:{my:"1.2rem"}}),s.jsxs(a,{container:!0,size:12,spacing:2,children:[s.jsxs(a,{item:!0,size:{xs:12,sm:6,md:4},children:[s.jsx(m,{sx:{mb:"5px",fontSize:"13px"},children:"User *"}),s.jsx(re,{width:"100%",items:O.map(e=>({value:e.id,name:`${e.name} (${e.email})`})),value:r("userId"),onChange:e=>c("userId",e,{shouldValidate:!0}),onSearchChange:e=>A(e),isLoading:V,shouldBeFullwidth:!0}),i.userId&&s.jsx(o,{color:"error",fontSize:"14px",children:i.userId.message})]}),s.jsxs(a,{item:!0,size:{xs:12,sm:6,md:4},children:[s.jsx(m,{sx:{mb:"5px",fontSize:"13px"},children:"From Account *"}),s.jsx(T,{items:[...L||[],`Wallet (${f?s.jsx(F,{}):Number(b).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:2})})`],value:r("mt5Login"),onChange:e=>c("mt5Login",e.target.value,{shouldValidate:!0}),shouldBeFullWidth:!0,disableItem:r("to"),shouldBeDisabled:!r("userId")}),i.network&&s.jsx(o,{color:"error",fontSize:"14px",children:i.network.message})]}),s.jsxs(a,{item:!0,size:{xs:12,sm:6,md:4},children:[s.jsx(m,{sx:{mb:"5px",fontSize:"13px"},children:"To Account *"}),s.jsx(T,{items:[...L||[],`Wallet (${f?s.jsx(F,{}):Number(b).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:2})})`],value:r("to"),onChange:e=>c("to",e.target.value,{shouldValidate:!0}),shouldBeFullWidth:!0,disableItem:r("mt5Login"),shouldBeDisabled:!r("userId")}),i.remark&&s.jsx(o,{color:"error",fontSize:"14px",children:i.remark.message})]}),s.jsxs(a,{item:!0,size:{xs:12,sm:6,md:4},children:[s.jsx(m,{sx:{mb:"5px",fontSize:"13px"},children:"Amount *"}),s.jsx(ee,{size:"small",...C("amount"),fullWidth:!0,placeholder:"Type your amount"}),i.amount&&s.jsx(o,{color:"error",fontSize:"14px",children:i.amount.message})]})]}),s.jsx(se,{type:"submit",variant:"contained",disabled:N||q,sx:{mt:"1.2rem",textTransform:"capitalize",boxShadow:"none",color:"white",fontSize:"16px",alignSelf:"flex-start","&:hover":{boxShadow:"none"}},children:"Submit"})]})]})}export{ue as default};
