import{bz as A,c as T,a as D,b as M,dk as P,j as e,S as u,T as n,G as y,I as W,aI as z,h as R,i as C,dl as B,av as _,Z as G,r as j,da as V,ay as k,B as q,aD as O}from"./index-oaA_Ltxz.js";import{M as E}from"./ModalComponent-DTq5tozF.js";const H=[{label:"Admin",value:"ADMIN"},{label:"User",value:"USER"}],Q=A.object({role:A.string({required_error:"Role is required",invalid_type_error:"Please select a valid role"})});function Z({data:t,onClose:s}){const i=t,l=T(),r={role:""},{handleSubmit:S,reset:d,watch:v,setValue:o,formState:{errors:m}}=D({resolver:M(Q),defaultValues:r}),[b,{isLoading:p}]=P(),f=async c=>{var h;try{const a=await b({userId:i,role:c.role}).unwrap();a!=null&&a.status&&(l(C({open:!0,message:a.message,severity:"success"})),d(r),s())}catch(a){l(C({open:!0,message:((h=a==null?void 0:a.data)==null?void 0:h.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return e.jsxs(u,{children:[e.jsx(n,{sx:{fontSize:"2rem",fontWeight:"700",mb:"2rem"},children:"Update User Role"}),e.jsxs(u,{component:"form",onSubmit:S(f),children:[e.jsx(y,{container:!0,size:12,spacing:2,children:e.jsxs(y,{size:{xs:12},children:[e.jsx(W,{sx:{mb:".5rem"},children:"Select Role *"}),e.jsx(z,{value:v("role"),items:H,onChange:c=>o("role",c.target.value,{shouldValidate:!0}),shouldBeFullWidth:!0,showDefaultOption:!0}),m.role&&e.jsx(n,{color:"error",fontSize:"14px",children:m.role.message})]})}),e.jsx(R,{variant:"contained",type:"submit",disabled:p,sx:{textTransform:"capitalize",boxShadow:"none",color:"white",mt:"1.5rem",alignSelf:"self-start","&:hover":{boxShadow:"none"}},children:"Submit"})]})]})}const $=[{label:"Active",value:"true"},{label:"Inactive",value:"false"}],J=A.object({isActive:A.string({required_error:"Status is required",invalid_type_error:"Please select a valid status"})});function K({data:t,onClose:s}){const i=t,l=T(),r={isActive:null},{handleSubmit:S,reset:d,watch:v,setValue:o,formState:{errors:m}}=D({resolver:M(J),defaultValues:r}),[b,{isLoading:p}]=B(),f=async c=>{var h;try{const a=await b({userId:i,isActive:c.isActive=="true"}).unwrap();a!=null&&a.status&&(l(C({open:!0,message:a.message,severity:"success"})),d(r),s())}catch(a){l(C({open:!0,message:((h=a==null?void 0:a.data)==null?void 0:h.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return e.jsxs(u,{children:[e.jsx(n,{sx:{fontSize:"2rem",fontWeight:700,mb:"2rem"},children:"Update User Status"}),e.jsxs(u,{component:"form",onSubmit:S(f),children:[e.jsx(y,{container:!0,spacing:2,children:e.jsxs(y,{size:{xs:12},children:[e.jsx(W,{sx:{mb:".5rem"},children:"Status *"}),e.jsx(z,{value:v("isActive"),items:$,onChange:c=>o("isActive",c.target.value,{shouldValidate:!0}),shouldBeFullWidth:!0,showDefaultOption:!0}),m.isActive&&e.jsx(n,{color:"error",fontSize:"14px",children:m.isActive.message})]})}),e.jsx(R,{variant:"contained",type:"submit",disabled:p,sx:{textTransform:"capitalize",boxShadow:"none",mt:"1.5rem",alignSelf:"flex-start","&:hover":{boxShadow:"none"}},children:"Submit"})]})]})}const g=_(),X=[g.display({header:"User Email",size:200,Cell:({row:t})=>e.jsx(n,{children:t.original.email})}),g.accessor("role",{header:"Role",size:150}),g.accessor("registeredDevice",{header:"Registered Device",size:150}),g.display({header:"Status",size:150,Cell:({row:t})=>e.jsx(n,{color:t.original.isActive?"green":"red",children:t.original.isActive?"Active":"Inactive"})}),g.display({header:"Location",size:150,Cell:({row:t})=>{var s,i;return e.jsxs(n,{children:[(s=t.original.location)==null?void 0:s.city,", ",(i=t.original.location)==null?void 0:i.country]})}}),g.accessor("createdAt",{header:"Created At",size:200,Cell:({row:t})=>e.jsx(n,{children:new Date(t.original.createdAt).toLocaleString()})}),g.display({header:"Action",size:300,Cell:({row:t})=>{var r;const s=(r=t==null?void 0:t.original)==null?void 0:r._id,i=t.original.email,l=t.original.userName;return e.jsxs(u,{sx:{flexDirection:"row",gap:"10px"},children:[e.jsx(E,{btnName:"Edit Status",Content:K,contentData:s,modalWidth:{xs:"90%",sm:600},btnSx:{color:"white",minWidth:"1.5rem",fontSize:"0.7rem",px:"8px",py:"4px"}}),e.jsx(E,{btnName:"Edit Role",Content:Z,contentData:s,modalWidth:{xs:"90%",sm:600},btnSx:{color:"white",minWidth:"1.5rem",fontSize:"0.7rem",px:"8px",py:"4px"}}),e.jsx(R,{component:G,to:"/admin/pushNotification/sendPushNotification",state:{email:i,userName:l,userId:s},sx:{color:"white",minWidth:"1.5rem",fontSize:"0.7rem",px:"8px",py:"4px"},variant:"contained",children:"Send Notification"})]})}})];function te(){var w,U,F,I;const[t,s]=j.useState({pageIndex:0,pageSize:10}),[i,l]=j.useState(""),[r,S]=j.useState(null),[d,v]=j.useState({status:"",role:""}),{data:o,isLoading:m,isError:b,error:p}=V({page:t.pageIndex+1,limit:t.limit,search:i,isActive:r,...d}),f=(w=p==null?void 0:p.data)==null?void 0:w.message,c=((U=o==null?void 0:o.data)==null?void 0:U.users)||[],h=k({columns:X,data:c,enableRowSelection:!0,enableSelectAll:!0,getRowId:x=>x._id,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,manualPagination:!0,manualFiltering:!0,rowCount:((I=(F=o==null?void 0:o.data)==null?void 0:F.pagination)==null?void 0:I.total)||0,state:{pagination:t,globalFilter:i,isLoading:m,showAlertBanner:b},initialState:{showGlobalFilter:!0},onPaginationChange:s,onGlobalFilterChange:l,columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiToolbarAlertBannerProps:b?{color:"error",children:f||"Error loading Documents List."}:void 0}),a=j.useCallback((x,L)=>{v(N=>({...N,[x]:L}))},[]);return e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"h5",fontWeight:"700",fontSize:"1.8rem",mb:"2rem",children:"All App User List"}),e.jsxs(q,{sx:{display:"flex",gap:"2rem"},children:[e.jsxs(u,{children:[e.jsx(n,{sx:{mb:"5px",fontSize:"12px"},children:"Status"}),e.jsx(z,{value:r,items:[{label:"Active",value:"true"},{label:"Inactive",value:"false"}],onChange:x=>S(x.target.value),width:{xs:"100%",sm:200}})]}),e.jsxs(u,{children:[e.jsx(n,{sx:{mb:"5px",fontSize:"12px"},children:"Role"}),e.jsx(z,{value:d==null?void 0:d.role,items:["USER","Admin"],onChange:x=>a("role",x.target.value),width:{xs:"100%",sm:200}})]})]}),e.jsx(u,{sx:{marginTop:"2rem",borderRadius:"1.2rem",overflow:"hidden"},children:e.jsx(O,{table:h})})]})}export{te as default};
