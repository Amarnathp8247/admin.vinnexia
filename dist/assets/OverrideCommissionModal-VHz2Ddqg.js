import{bz as t,aW as P,c as z,bA as E,a as w,b as O,r as k,bB as F,bC as M,j as r,S as T,T as S,I as W,e as _,h as B,k as g}from"./index-B_S0l-pH.js";const D=t.object({ibPlanId:t.number({required_error:"Plan is required"}).nullable().refine(s=>s!==null,{message:"Plan is required"}),subIbId:t.number({required_error:"Sub is required"}).nullable().refine(s=>s!==null,{message:"Sub is required"}),amount:t.string().min(1,"Commission is required")}).transform(s=>Object.fromEntries(Object.entries(s).filter(([m,i])=>i!==void 0)));function A({data:s,onClose:m}){var d,p;const{id:i}=P(),a=z(),{data:u,isLoading:x}=E({planId:i},{skip:!i}),b={ibPlanId:null,subIbId:null,amount:""},{register:h,handleSubmit:j,reset:l,formState:{errors:c}}=w({resolver:O(D),defaultValues:b});k.useEffect(()=>{l({ibPlanId:+i,subIbId:s==null?void 0:s.userId})},[s,i]);const[C,{isLoading:y}]=F(),[q,{isLoading:L}]=M(),o=!x&&((p=(d=u==null?void 0:u.data)==null?void 0:d.filter(n=>n.id==(s==null?void 0:s.userId))[0])==null?void 0:p.comissionDetaild),v=async n=>{var I,f;try{const e=o?await q({comissionId:o==null?void 0:o.id,amount:n==null?void 0:n.amount}).unwrap():await C(n).unwrap();e!=null&&e.status&&(a(g({open:!0,message:e==null?void 0:e.message,severity:"success"})),l(b),m())}catch(e){(I=e==null?void 0:e.data)!=null&&I.status||a(g({open:!0,message:((f=e==null?void 0:e.data)==null?void 0:f.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return r.jsxs(T,{component:"form",onSubmit:j(v),children:[r.jsx(S,{fontWeight:700,fontSize:"1.5rem",mb:"10px",children:o?"Update commission":"Set commission"}),r.jsx(W,{sx:{mb:".5rem"},children:"Commission"}),r.jsx(_,{...h("amount",{required:!0}),size:"small",fullWidth:!0,variant:"outlined",placeholder:"Enter commission"}),c.amount&&r.jsx(S,{color:"error",fontSize:"14px",children:c.amount.message}),r.jsx(B,{variant:"contained",sx:{mt:"15px"},type:"submit",disabled:y||L,children:"Submit"})]})}export{A as O};
