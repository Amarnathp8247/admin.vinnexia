import{o as B,s as h,aC as N,X as W,c as $,r as v,a as G,av as U,aI as A,b4 as Q,j as e,S as R,T as m,aF as X,G as x,I as u,aG as _,e as H,h as J,b as K,k as z}from"./index-BuLT-AS9.js";import{S as O}from"./SearchableSelector-DnYtu6tK.js";import{M as Y}from"./MoneyInput-CfTSpKUz.js";import{C as Z}from"./Card-C53o8KFk.js";const ee=B({userId:N({required_error:"Client is required"}).nullable().refine(t=>t!==null,{message:"Client is required"}),mt5Login:h().min(1,"MT5 user is required"),amount:h().min(1,"Please type deposit amount"),comment:h().min(1,"Please type your comment").min(3,"Atlease 3 characters mandatory"),type:h()});function ae(){var I;const{state:t}=W(),l=t==null?void 0:t.Login,i=t==null?void 0:t.userId,D=t==null?void 0:t.Name,w=t==null?void 0:t.Email,S=$(),[g,T]=v.useState(""),j={userId:null,mt5Login:"",amount:"",comment:"",type:"2"},{register:F,handleSubmit:P,reset:E,watch:n,setValue:o,formState:{errors:a}}=G({resolver:K(ee),defaultValues:j});v.useEffect(()=>{i&&o("userId",i),l?o("mt5Login",l):o("mt5Login","")},[i,l,o]);const b=n("userId"),{data:p,isLoading:M}=U({page:1,sizePerPage:10,search:g},{skip:g.length<3}),{data:f}=A({page:1,sizePerPage:10,id:b},{skip:!b}),L=g.length>=3?((I=p==null?void 0:p.data)==null?void 0:I.usersList)||[]:[],y=L.find(s=>s.id===n("userId")),C=y?((f==null?void 0:f.data)||[]).filter(s=>{var d,c;return((d=s.email||s.Email)==null?void 0:d.toLowerCase())===((c=y.email)==null?void 0:c.toLowerCase())}):[],[q,{isLoading:V}]=Q(),k=async s=>{var d,c;try{const r=await q(s).unwrap();r!=null&&r.status&&(S(z({open:!0,message:r==null?void 0:r.message,severity:"success"})),E({...j,userId:i?n("userId"):null,mt5Login:l?n("mt5Login"):""}))}catch(r){(d=r==null?void 0:r.data)!=null&&d.status||S(z({open:!0,message:((c=r==null?void 0:r.data)==null?void 0:c.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return e.jsxs(R,{children:[e.jsx(m,{sx:{fontSize:"2rem",fontWeight:"700"},children:"Client Deposit"}),e.jsxs(Z,{sx:{boxShadow:"0 0px 0px 0 rgba(0, 0, 0, 0.19), 0 0px 8px 0 rgba(0, 0, 0, 0.19)",borderRadius:"1.2rem",padding:{xs:"1rem",md:"2rem"},mt:"2rem"},component:"form",onSubmit:P(k),children:[e.jsx(m,{mx:{xs:"1rem",md:"0"},children:"Fill Details"}),e.jsx(X,{sx:{my:"1.2rem"}}),e.jsxs(x,{container:!0,size:12,spacing:2,children:[e.jsxs(x,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(u,{sx:{mb:".5rem"},children:"Select Client *"}),e.jsx(O,{width:"100%",disabled:i,items:i?[{value:i,name:`${D} (${w})`}]:L.map(s=>({value:s.id,name:`${s.name} (${s.email})`})),value:n("userId"),onChange:s=>o("userId",s,{shouldValidate:!0}),onSearchChange:s=>T(s),isLoading:M,shouldBeFullwidth:!0}),e.jsx(u,{sx:{fontSize:"12px"},children:"Please enter 3 or more characters"}),a.userId&&e.jsx(m,{color:"error",fontSize:"14px",children:a.userId.message})]}),e.jsxs(x,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(u,{sx:{mb:".5rem"},children:"Select MT5 ID *"}),e.jsx(_,{shouldBeDisabled:!C.length>0,value:n("mt5Login"),onChange:s=>o("mt5Login",s.target.value,{shouldValidate:!0}),items:i?[{value:l,name:l}]:C.map(s=>({value:s.Login,name:s.Login})),shouldBeFullWidth:!0}),e.jsx(u,{sx:{fontSize:"12px"},children:"First select client"}),a.mt5Login&&e.jsx(m,{color:"error",fontSize:"14px",children:a.mt5Login.message})]}),e.jsxs(x,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(u,{sx:{mb:".5rem"},children:"Amount IN USD"}),e.jsx(Y,{size:"small",fullWidth:!0,variant:"outlined",value:n("amount"),onChange:s=>o("amount",s,{shouldValidate:!0})}),a.amount&&e.jsx(m,{color:"error",fontSize:"14px",children:a.amount.message})]}),e.jsxs(x,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(u,{sx:{mb:".5rem"},children:"Comment"}),e.jsx(H,{...F("comment",{required:!0}),size:"small",multiline:!0,fullWidth:!0,variant:"outlined",placeholder:"Enter Comment"}),a.comment&&e.jsx(m,{color:"error",fontSize:"14px",children:a.comment.message})]})]}),e.jsx(J,{variant:"contained",type:"submit",disabled:V,sx:{textTransform:"capitalize",boxShadow:"none",color:"white",mt:"1.5rem",alignSelf:"self-start","&:hover":{boxShadow:"none"}},children:"Submit"})]})]})}export{ae as default};
