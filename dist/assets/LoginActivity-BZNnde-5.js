import{r as d,aw as y,j as e,T as j,az as b,B as h,S as m,I as u,aA as f,aB as g,at as z,h as D}from"./index-DcG3qw6T.js";import{f as r}from"./chunk-IHAWQA3S-C2e_0_q3.js";import{d as l}from"./dayjs.min-CpAZ4qKR.js";import{F as w}from"./FileDownload-rr-bL3sD.js";import{u as p,w as S}from"./xlsx-D1NZSDnX.js";import{A as T}from"./AdapterDayjs-DPH4TRzJ.js";const A=(a=10)=>Array.from({length:a},(n,t)=>({id:t+1,name:r.person.fullName(),email:r.internet.email(),ip:r.internet.ip(),city:r.location.city(),state:r.location.state(),country:r.location.country(),date:r.date.recent().toLocaleDateString()})),x=A(5),o=z(),v=[o.accessor("id",{header:"ID",size:40}),o.accessor("name",{header:"Name",size:180}),o.accessor("email",{header:"Email",size:200}),o.accessor("ip",{header:"IP Address",size:140}),o.accessor("city",{header:"City",size:120}),o.accessor("state",{header:"State",size:120}),o.accessor("country",{header:"Country",size:140}),o.accessor("date",{header:"Date",size:120})],F=a=>{const n=a.map(c=>c.original),t=p.json_to_sheet(n),i=p.book_new();p.book_append_sheet(i,t,"Sheet1"),S(i,"data.xlsx")};function _(){const[a,n]=d.useState(null),[t,i]=d.useState(null);d.useMemo(()=>!a||!t?x:x.filter(s=>l(s.date).isAfter(l(a).subtract(1,"day"))&&l(s.date).isBefore(l(t).add(1,"day"))),[a,t]);const c=y({columns:v,data:[],columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",renderTopToolbarCustomActions:({table:s})=>e.jsx(h,{sx:{display:"flex",gap:"16px",padding:"8px",flexWrap:"wrap"},children:e.jsx(D,{variant:"contained",onClick:()=>F(x),startIcon:e.jsx(w,{sx:{color:"white"}}),sx:{textTransform:"none",color:"white",boxShadow:"none","&:hover":{boxShadow:"none"}},children:"Excel"})})});return e.jsxs(e.Fragment,{children:[e.jsx(j,{variant:"h5",fontWeight:"700",fontSize:"1.8rem",mb:"2rem",children:"Login Activity"}),e.jsx(b,{dateAdapter:T,children:e.jsxs(h,{sx:{display:"flex",gap:"1rem",flexDirection:{xs:"column",sm:"row"}},children:[e.jsxs(m,{children:[e.jsx(u,{sx:{mb:".5rem",fontSize:"12px"},children:"From:"}),e.jsx(f,{value:a,onChange:s=>n(s),slotProps:{textField:{size:"small"}}})]}),e.jsxs(m,{children:[e.jsx(u,{sx:{mb:".5rem",fontSize:"12px"},children:"To:"}),e.jsx(f,{value:t,onChange:s=>i(s),slotProps:{textField:{size:"small"}}})]})]})}),e.jsx(m,{sx:{marginTop:"2rem",borderRadius:"1.2rem",overflow:"hidden"},children:e.jsx(g,{table:c})})]})}export{_ as default};
