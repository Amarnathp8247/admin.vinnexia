import{ao as I,c as V,a as W,b as Y,o as L,cU as O,j as e,S as c,T as n,G as k,I as u,aG as C,e as G,h as H,s as v,k as N,B as j,at as _,r as h,aS as J,aw as Q,az as U,aA as M,aB as q}from"./index-DcG3qw6T.js";import{d as B}from"./dayjs.min-CpAZ4qKR.js";import{M as R}from"./ModalComponent-Csv_Esyn.js";import{A as K}from"./AdapterDayjs-DPH4TRzJ.js";const X=L({status:v().min(1,"Please select your status"),remark:v().min(1,"Please type your remark").min(3,"Atlease 3 characters mandatory")});function Z({data:t,onClose:s}){const{refetch:l}=I(),p=t,r=V(),y={status:"",remark:""},{handleSubmit:D,watch:E,register:m,setValue:P,reset:S,getValues:b,formState:{errors:x}}=W({resolver:Y(X),defaultValues:y}),[T,{isLoading:A}]=O(),z=async g=>{var d,f;try{const a=await T({...g,depositId:p}).unwrap();a!=null&&a.status&&(r(N({open:!0,message:a==null?void 0:a.message,severity:"success"})),S(y),s(),l())}catch(a){(d=a==null?void 0:a.data)!=null&&d.status||r(N({open:!0,message:((f=a==null?void 0:a.data)==null?void 0:f.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return e.jsxs(c,{children:[e.jsx(n,{sx:{fontSize:"2rem",fontWeight:"700",mb:"1.2rem"},children:"Edit pending transaction status"}),e.jsxs(c,{component:"form",onSubmit:D(z),children:[e.jsxs(k,{container:!0,size:12,spacing:3,children:[e.jsxs(k,{size:{xs:12},children:[e.jsx(u,{sx:{mb:".5rem"},children:"Status *"}),e.jsx(C,{items:["APPROVED","REJECTED"],value:E("status"),shouldBeFullWidth:!0,onChange:g=>P("status",g.target.value,{shouldValidate:!0})}),x.status&&e.jsx(n,{color:"error",fontSize:"14px",children:x.status.message})]}),e.jsxs(k,{size:{xs:12},children:[e.jsx(u,{sx:{mb:".5rem"},children:"Remark *"}),e.jsx(G,{...m("remark",{required:!0}),size:"small",fullWidth:!0,placeholder:"Enter Subject",variant:"outlined"}),x.remark&&e.jsx(n,{color:"error",fontSize:"14px",children:x.remark.message})]})]}),e.jsx(H,{type:"submit",variant:"contained",disabled:A,sx:{textTransform:"capitalize",boxShadow:"none",color:"white",mt:"1.5rem",alignSelf:"self-start","&:hover":{boxShadow:"none"}},children:"Submit"})]})]})}function $({data:t}){const s={"Holder Name":(t==null?void 0:t.holderName)||"NA","Bank Name":(t==null?void 0:t.bankName)||"NA","Account No.":(t==null?void 0:t.accountNo)||"NA","IBAN No":(t==null?void 0:t.ibanNo)||"NA","IFSC Code":(t==null?void 0:t.ifscCode)||"NA","Bank Address":(t==null?void 0:t.bankAddress)||"NA",Country:(t==null?void 0:t.country)||"NA"};return e.jsxs(c,{spacing:2,sx:{px:{xs:1,sm:2}},children:[e.jsx(n,{variant:"h5",fontWeight:"700",fontSize:"1.8rem",mb:"2rem",children:"Bank Details"}),Object.entries(s).map(([l,p],r)=>e.jsxs(j,{display:"flex",justifyContent:"space-between",alignItems:"center",sx:{borderBottom:"1px solid #e0e0e0",pb:1},children:[e.jsx(n,{variant:"body2",fontWeight:600,color:"text.secondary",children:l}),e.jsx(n,{variant:"body2",color:"text.primary",children:p})]},r))]})}const o=_(),ee=[o.accessor("id",{header:"ID"}),o.display({header:"Name",Cell:({row:t})=>{const s=t.original.user.name;return s?e.jsx(n,{children:s}):e.jsx(n,{fontSize:"12px",component:"em",children:"Empty"})}}),o.display({header:"Email",Cell:({row:t})=>{const s=t.original.user.email;return s?e.jsx(n,{children:s}):e.jsx(n,{fontSize:"12px",component:"em",children:"Empty"})}}),o.accessor("amount",{header:"Amount",Cell:({row:t})=>{const s=t.original.amount;return s?e.jsx(n,{children:s}):e.jsx(n,{fontSize:"12px",component:"em",children:"Empty"})}}),o.display({id:"image",header:"Deposit Proof",Cell:({row:t})=>{var l;const s=(l=t==null?void 0:t.original)==null?void 0:l.image;return s?e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:e.jsx("img",{src:s,alt:"Bankbook",style:{width:"50px",height:"auto",borderRadius:"4px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"}})}):e.jsx(n,{fontSize:"12px",component:"em",children:"Empty"})}}),o.accessor("transactionType",{header:"Transaction Type",Cell:({row:t})=>{const s=t.original.transactionType;return s?e.jsx(n,{children:s}):e.jsx(n,{fontSize:"12px",component:"em",children:"Empty"})}}),o.accessor("paymentMethods",{header:"Payment Methods",Cell:({row:t})=>{const s=t.original.paymentMethods;return s?e.jsx(n,{children:s}):e.jsx(n,{fontSize:"12px",component:"em",children:"Empty"})}}),o.accessor("walletAddress",{header:"Wallet Address",Cell:({row:t})=>{const s=t.original.walletAddress;return s?e.jsx(n,{children:s}):e.jsx(n,{fontSize:"12px",component:"em",children:"Empty"})}}),o.accessor("transactionReference",{header:"Transaction Reference",Cell:({row:t})=>{const s=t.original.transactionReference;return s?e.jsx(n,{children:s}):e.jsx(n,{fontSize:"12px",component:"em",children:"Empty"})}}),o.accessor("remark",{header:"Remark",Cell:({row:t})=>{const s=t.original.remark;return s?e.jsx(n,{children:s}):e.jsx(n,{fontSize:"12px",component:"em",children:"Empty"})}}),o.accessor("status",{header:"Status",Cell:({row:t})=>{const s=t.original.status;return s?e.jsx(n,{children:s}):e.jsx(n,{fontSize:"12px",component:"em",children:"Empty"})}}),o.accessor("approvedBy",{header:"Approved By",Cell:({row:t})=>{const s=t.original.approvedBy;return s?e.jsx(n,{children:s}):e.jsx(n,{fontSize:"12px",component:"em",children:"Empty"})}}),o.accessor("createdAt",{header:"Date",size:250,Cell:({row:t})=>e.jsx(n,{children:new Date(t.original.createdAt).toLocaleString()})}),o.display({id:"action",header:"Action",size:200,Cell:({row:t})=>e.jsxs(j,{sx:{display:"flex",gap:"5px"},children:[t.original.bank&&e.jsx(R,{modalWidth:{xs:"90%",sm:600},btnName:"Bank Details",Content:$,contentData:t.original.bank}),e.jsx(R,{modalWidth:{xs:"90%",sm:600},btnName:"Edit",Content:Z,contentData:t.original.id})]})})],te=["PENDING","COMPLETED","PROCESSING","REJECTED"],se=["WITHDRAW","DEPOSIT"],ne=["BANK","CASH","CRYPTO"];function le(){var f,a;const[t,s]=h.useState({pageIndex:0,pageSize:10}),[l,p]=h.useState(""),[r,y]=h.useState({status:"",transactionType:"",paymentMethod:"",fromDate:null,toDate:null}),D=r.fromDate?B(r.fromDate).format("YYYY-MM-DD"):void 0,E=r.toDate?B(r.toDate).format("YYYY-MM-DD"):void 0,{data:m,isLoading:P,isError:S,error:b}=J({page:t.pageIndex+1,sizePerPage:t.pageSize,search:l,...r,fromDate:D,toDate:E,status:"PENDING"}),x=(f=b==null?void 0:b.data)==null?void 0:f.message,T=(m==null?void 0:m.data)||[],A=h.useMemo(()=>ee,[]),z=h.useMemo(()=>T,[T]),g=Q({columns:A,data:z,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,manualPagination:!0,manualFiltering:!0,rowCount:((a=m==null?void 0:m.data)==null?void 0:a.totalRecords)||0,state:{pagination:t,globalFilter:l,isLoading:P,showAlertBanner:S},onPaginationChange:s,onGlobalFilterChange:p,columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiToolbarAlertBannerProps:S?{color:"error",children:x||"Error loading Pending transaction list."}:void 0}),d=h.useCallback((i,w)=>{y(F=>({...F,[i]:w}))},[]);return e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"h5",fontWeight:700,fontSize:"1.8rem",mb:4,children:"Pending transaction list"}),e.jsxs(j,{sx:{display:"flex",flexDirection:{xs:"column",lg:"row"},gap:2,flexWrap:"wrap",mb:4},children:[e.jsxs(j,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:2},children:[e.jsxs(c,{children:[e.jsx(u,{sx:{mb:.5,fontSize:12},children:"Status"}),e.jsx(C,{items:te,value:r.status,onChange:i=>d("status",i.target.value),width:{xs:"100%",sm:200}})]}),e.jsxs(c,{children:[e.jsx(u,{sx:{mb:.5,fontSize:12},children:"Transaction Type"}),e.jsx(C,{items:se,value:r.transactionType,onChange:i=>d("transactionType",i.target.value),width:{xs:"100%",sm:200}})]}),e.jsxs(c,{children:[e.jsx(u,{sx:{mb:.5,fontSize:12},children:"Payment Method"}),e.jsx(C,{items:ne,value:r.paymentMethod,onChange:i=>d("paymentMethod",i.target.value),width:{xs:"100%",sm:200}})]})]}),e.jsx(U,{dateAdapter:K,children:e.jsxs(j,{sx:{display:"flex",gap:2,flexDirection:{xs:"column",sm:"row"}},children:[e.jsxs(c,{children:[e.jsx(u,{sx:{mb:.5,fontSize:12},children:"From"}),e.jsx(M,{value:r.fromDate,onChange:i=>d("fromDate",i),slotProps:{textField:{size:"small"},field:{clearable:!0}}})]}),e.jsxs(c,{children:[e.jsx(u,{sx:{mb:.5,fontSize:12},children:"To"}),e.jsx(M,{value:r.toDate,onChange:i=>d("toDate",i),slotProps:{textField:{size:"small"},field:{clearable:!0}}})]})]})})]}),e.jsx(c,{sx:{mt:4,borderRadius:2,overflow:"hidden"},children:e.jsx(q,{table:g})})]})}export{le as default};
