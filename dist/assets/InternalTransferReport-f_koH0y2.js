import{r as m,aw as b,j as e,T as j,az as g,B as u,S as d,I as h,aA as f,aB as D,at as T,h as A}from"./index-DcG3qw6T.js";import{f as r}from"./chunk-IHAWQA3S-C2e_0_q3.js";import{d as c}from"./dayjs.min-CpAZ4qKR.js";import{F as w}from"./FileDownload-rr-bL3sD.js";import{u as x,w as z}from"./xlsx-D1NZSDnX.js";import{A as S}from"./AdapterDayjs-DPH4TRzJ.js";const y=(a=10)=>Array.from({length:a},(n,o)=>({id:o+1,name:`${r.person.fullName()} / ${r.internet.email()}`,fromAccount:r.finance.iban(),toAccount:r.finance.iban(),amount:r.finance.amount({min:50,max:5e3,dec:2}),date:r.date.recent().toLocaleDateString(),marketingName:r.person.firstName()})),p=y(1),s=T(),k=[s.accessor("id",{header:"ID",size:40}),s.accessor("name",{header:"Name/Email",size:180}),s.accessor("fromAccount",{header:"From Account",size:140}),s.accessor("toAccount",{header:"To Account",size:140}),s.accessor("amount",{header:"Amount IN USD",size:120}),s.accessor("date",{header:"Date",size:120}),s.accessor("marketingName",{header:"Marketing Name",size:140})],F=a=>{const n=a.map(l=>l.original),o=x.json_to_sheet(n),i=x.book_new();x.book_append_sheet(i,o,"Sheet1"),z(i,"data.xlsx")};function E(){const[a,n]=m.useState(null),[o,i]=m.useState(null);m.useMemo(()=>!a||!o?p:p.filter(t=>c(t.date).isAfter(c(a).subtract(1,"day"))&&c(t.date).isBefore(c(o).add(1,"day"))),[a,o]);const l=b({columns:k,data:[],columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",renderTopToolbarCustomActions:({table:t})=>e.jsx(u,{sx:{display:"flex",gap:"16px",padding:"8px",flexWrap:"wrap"},children:e.jsx(A,{variant:"contained",onClick:()=>F(p),startIcon:e.jsx(w,{sx:{color:"white"}}),sx:{textTransform:"none",color:"white",boxShadow:"none","&:hover":{boxShadow:"none"}},children:"Excel"})})});return e.jsxs(e.Fragment,{children:[e.jsx(j,{variant:"h5",fontWeight:"700",fontSize:"1.8rem",mb:"2rem",children:"Internal Transfer Report"}),e.jsx(g,{dateAdapter:S,children:e.jsxs(u,{sx:{display:"flex",gap:"1rem",flexDirection:{xs:"column",sm:"row"}},children:[e.jsxs(d,{children:[e.jsx(h,{sx:{mb:".5rem",fontSize:"12px"},children:"From:"}),e.jsx(f,{value:a,onChange:t=>n(t),slotProps:{textField:{size:"small"}}})]}),e.jsxs(d,{children:[e.jsx(h,{sx:{mb:".5rem",fontSize:"12px"},children:"To:"}),e.jsx(f,{value:o,onChange:t=>i(t),slotProps:{textField:{size:"small"}}})]})]})}),e.jsx(d,{sx:{marginTop:"2rem",borderRadius:"1.2rem",overflow:"hidden"},children:e.jsx(D,{table:l})})]})}export{E as default};
