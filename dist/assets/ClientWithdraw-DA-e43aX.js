import{o as k,s as x,aC as B,X as $,c as G,r as C,a as N,av as U,aI as A,b5 as Q,j as e,S as R,T as m,aF as X,G as h,I as u,aG as _,e as H,h as J,b as K,k as v}from"./index-B_S0l-pH.js";import{S as O}from"./SearchableSelector-C9pLKMko.js";import{M as Y}from"./MoneyInput-BLo1ppTO.js";import{C as Z}from"./Card-BbyUSaIa.js";const ee=k({userId:B({required_error:"Client is required"}).nullable().refine(t=>t!==null,{message:"Client is required"}),mt5Login:x().min(1,"MT5 user is required"),amount:x().min(1,"Please type withdraw amount"),comment:x().min(1,"Please type your comment").min(3,"Atlease 3 characters mandatory"),type:x()});function ie(){var w;const{state:t}=$(),l=t==null?void 0:t.Login,a=t==null?void 0:t.userId,z=t==null?void 0:t.Name,T=t==null?void 0:t.Email,S=G(),[g,P]=C.useState(""),j={userId:null,mt5Login:"",amount:"",comment:"",type:"2"},{register:W,handleSubmit:D,reset:F,watch:n,setValue:o,formState:{errors:i}}=N({resolver:K(ee),defaultValues:j});C.useEffect(()=>{a&&o("userId",a),l?o("mt5Login",l):o("mt5Login","")},[a,l,o]);const b=n("userId"),{data:p,isLoading:E}=U({page:1,sizePerPage:10,search:g},{skip:g.length<3}),{data:f}=A({page:1,sizePerPage:10,id:b},{skip:!b}),L=g.length>=3?((w=p==null?void 0:p.data)==null?void 0:w.usersList)||[]:[],y=L.find(s=>s.id===n("userId")),I=y?((f==null?void 0:f.data)||[]).filter(s=>{var d,c;return((d=s.email||s.Email)==null?void 0:d.toLowerCase())===((c=y.email)==null?void 0:c.toLowerCase())}):[],[M,{isLoading:q}]=Q(),V=async s=>{var d,c;try{const r=await M(s).unwrap();r!=null&&r.status&&(S(v({open:!0,message:r==null?void 0:r.message,severity:"success"})),F({...j,userId:a?n("userId"):null,mt5Login:l?n("mt5Login"):""}))}catch(r){(d=r==null?void 0:r.data)!=null&&d.status||S(v({open:!0,message:((c=r==null?void 0:r.data)==null?void 0:c.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return e.jsxs(R,{children:[e.jsx(m,{sx:{fontSize:"2rem",fontWeight:"700"},children:"Client Withdraw"}),e.jsxs(Z,{sx:{boxShadow:"0 0px 0px 0 rgba(0, 0, 0, 0.19), 0 0px 8px 0 rgba(0, 0, 0, 0.19)",borderRadius:"1.2rem",padding:{xs:"1rem",md:"2rem"},mt:"2rem"},component:"form",onSubmit:D(V),children:[e.jsx(m,{mx:{xs:"1rem",md:"0"},children:"Fill Details"}),e.jsx(X,{sx:{my:"1.2rem"}}),e.jsxs(h,{container:!0,size:12,spacing:2,children:[e.jsxs(h,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(u,{sx:{mb:".5rem"},children:"Select Client *"}),e.jsx(O,{width:"100%",disabled:a,items:a?[{value:a,name:`${z} (${T})`}]:L.map(s=>({value:s.id,name:`${s.name} (${s.email})`})),value:n("userId"),onChange:s=>o("userId",s,{shouldValidate:!0}),onSearchChange:s=>P(s),isLoading:E,shouldBeFullwidth:!0}),e.jsx(u,{sx:{fontSize:"12px"},children:"Please enter 3 or more characters"}),i.userId&&e.jsx(m,{color:"error",fontSize:"14px",children:i.userId.message})]}),e.jsxs(h,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(u,{sx:{mb:".5rem"},children:"Select MT5 ID *"}),e.jsx(_,{shouldBeDisabled:!I.length>0,value:n("mt5Login"),onChange:s=>o("mt5Login",s.target.value,{shouldValidate:!0}),items:a?[{value:l,name:l}]:I.map(s=>({value:s.Login,name:s.Login})),shouldBeFullWidth:!0}),e.jsx(u,{sx:{fontSize:"12px"},children:"First select client"}),i.mt5Login&&e.jsx(m,{color:"error",fontSize:"14px",children:i.mt5Login.message})]}),e.jsxs(h,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(u,{sx:{mb:".5rem"},children:"Amount In USD*"}),e.jsx(Y,{size:"small",fullWidth:!0,variant:"outlined",value:n("amount"),onChange:s=>o("amount",s,{shouldValidate:!0})}),i.amount&&e.jsx(m,{color:"error",fontSize:"14px",children:i.amount.message})]}),e.jsxs(h,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(u,{sx:{mb:".5rem"},children:"comment *"}),e.jsx(H,{...W("comment",{required:!0}),size:"small",multiline:!0,fullWidth:!0,variant:"outlined",placeholder:"Please type your comment here"}),i.comment&&e.jsx(m,{color:"error",fontSize:"14px",children:i.comment.message})]})]}),e.jsx(J,{variant:"contained",type:"submit",disabled:q,sx:{textTransform:"capitalize",boxShadow:"none",color:"white",mt:"1.5rem",alignSelf:"self-start","&:hover":{boxShadow:"none"}},children:"Submit"})]})]})}export{ie as default};
