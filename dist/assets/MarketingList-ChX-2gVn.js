import{o as E,aE as F,c as I,r as v,b7 as D,a as R,b as B,bP as N,j as a,S as k,T as x,B as w,I as G,h as M,i as S,av as $,U as q,Z as j,bQ as H,a2 as V,ay as Q,aD as W}from"./index-oaA_Ltxz.js";import{M as K}from"./ModalComponent-DTq5tozF.js";import{S as U}from"./SearchableSelector-B0BDCd1f.js";const Z=E({managerId:F({required_error:"Marketing member is required"}).nullable().refine(e=>e!==null,{message:"Marketing member is required"})});function _({data:e,onClose:t}){var C;const i=e,s=I(),[o,l]=v.useState(""),u={marketingId:null},{data:c,isLoading:g}=D({page:1,sizePerPage:10,search:o,role:"MANAGER"},{skip:o.length<3}),n=o.length>=3?((C=c==null?void 0:c.data)==null?void 0:C.usersList)||[]:[],{handleSubmit:y,reset:T,watch:b,setValue:f,formState:{errors:p}}=R({resolver:B(Z),defaultValues:u}),[h,{isLoading:z}]=N(),P=async d=>{var L,A;try{const r=await h({...d,marketingId:i}).unwrap();r!=null&&r.status&&(s(S({open:!0,message:r==null?void 0:r.message,severity:"success"})),T(u),t())}catch(r){(L=r==null?void 0:r.data)!=null&&L.status||s(S({open:!0,message:((A=r==null?void 0:r.data)==null?void 0:A.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return a.jsxs(k,{component:"form",onSubmit:y(P),children:[a.jsx(x,{fontWeight:700,fontSize:"1.5rem",mb:"1.5rem",children:"Assign To"}),a.jsxs(w,{children:[a.jsx(G,{sx:{mb:".5rem"},children:"Select Marketing *"}),a.jsx(U,{width:"100%",items:n.map(d=>({value:d.id,name:`${d.name} (${d.email})`})),value:b("managerId"),onChange:d=>f("managerId",d,{shouldValidate:!0}),onSearchChange:d=>l(d),isLoading:g,shouldBeFullwidth:!0}),p.managerId&&a.jsx(x,{color:"error",fontSize:"14px",children:p.managerId.message})]}),a.jsx(M,{type:"submit",variant:"contained",disabled:z,sx:{textTransform:"capitalize",boxShadow:"none",color:"white",mt:"1.5rem",alignSelf:"self-start","&:hover":{boxShadow:"none"}},children:"Assign"})]})}const m=$(),J=[m.accessor("id",{header:"Id",size:40}),m.accessor("name",{header:"Manager/Marketer Name",size:200,Cell:({row:e})=>{var s,o;const{pathname:t}=q(),i=(s=e==null?void 0:e.original)==null?void 0:s.id;return a.jsx(x,{component:j,to:`/admin/marketing/marketingDetails/summary/${i}`,state:{pathname:t},sx:{color:"inherit"},children:(o=e==null?void 0:e.original)==null?void 0:o.name})}}),m.accessor("email",{header:"Email",size:80}),m.accessor("mobile",{header:"Mobile",size:80}),m.accessor("role",{header:"Role",size:80}),m.display({id:"Assigned To",header:"Assigned To",Cell:({row:e})=>{var i,s;const t=(s=(i=e==null?void 0:e.original)==null?void 0:i.manager)==null?void 0:s.name;return a.jsx(x,{children:t||"NA"})}}),m.accessor("status",{header:"Status",size:150,Cell:({row:e})=>{const t=e.original.isDeleted;return a.jsx(k,{sx:{flexDirection:"row",gap:"10px",color:t?"red":"green"},children:t?"Inactive":"Active"})}}),m.display({id:"action",header:"Action",Cell:({row:e})=>{const t=e.original.id,i=e.original.isDeleted,s=I(),[o,{isLoading:l}]=H(),u=async()=>{var c,g;try{const n=await o({isDeleted:i?"false":"true",marketingId:t}).unwrap();n!=null&&n.status&&s(S({open:!0,message:n==null?void 0:n.message,severity:"success"}))}catch(n){(c=n==null?void 0:n.data)!=null&&c.status||s(S({open:!0,message:((g=n==null?void 0:n.data)==null?void 0:g.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return a.jsxs(k,{sx:{flexDirection:"row",gap:"10px"},children:[a.jsx(M,{component:j,to:`/admin/marketing/editMarketing/${t}`,variant:"contained",sx:{textTransform:"none",color:"white",fontSize:"0.7rem",px:"8px",py:"4px"},children:"Edit"}),e.original.role=="MARKETING"&&a.jsx(K,{btnName:"Assign To",Content:_,contentData:t,btnSx:{textTransform:"none",color:"white",fontSize:"0.7rem",px:"8px",py:"4px"}}),a.jsx(M,{onClick:u,type:"submit",variant:"contained",disabled:l,sx:{textTransform:"none",color:"white",fontSize:"0.7rem",px:"8px",py:"4px"},children:i?"Recover":"Delete"})]})}}),m.display({id:"permission",header:"Permission",size:200,Cell:({row:e})=>{const t=e.original.id,i=e.original.name;return a.jsx(M,{component:j,to:"/admin/marketing/editPermission",state:{marketingId:t,marketingMemberName:i},variant:"contained",sx:{textTransform:"none",color:"white",fontSize:"0.7rem",px:"8px",py:"4px"},children:"Edit Permission"})}})];function ee(){var b,f,p;const{selectedTheme:e}=V(h=>h.themeMode),[t,i]=v.useState({pageIndex:0,pageSize:10}),[s,o]=v.useState(""),{data:l,isLoading:u,isError:c,error:g}=D({page:t.pageIndex+1,sizePerPage:t.pageSize,search:s}),n=(b=g==null?void 0:g.data)==null?void 0:b.message,y=((f=l==null?void 0:l.data)==null?void 0:f.usersList)||[],T=Q({columns:J,data:y,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,manualPagination:!0,manualFiltering:!0,rowCount:((p=l==null?void 0:l.data)==null?void 0:p.totalRecords)||0,state:{pagination:t,globalFilter:s,isLoading:u,showAlertBanner:c},onPaginationChange:i,onGlobalFilterChange:o,columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiToolbarAlertBannerProps:c?{color:"error",children:n||"Error loading Marketing List."}:void 0,muiTableBodyRowProps:({row:h,theme:z})=>({sx:{backgroundColor:h.original.isDeleted&&"#f77f8bff","&:hover":{backgroundColor:h.original.isDeleted&&"#ffcdd2"}}})});return a.jsxs(a.Fragment,{children:[a.jsx(x,{variant:"h5",fontWeight:"700",fontSize:"1.8rem",mb:"2rem",children:"Marketing List"}),a.jsx(k,{sx:{marginTop:"2rem",borderRadius:"1.2rem",overflow:"hidden"},children:a.jsx(W,{table:T})})]})}export{ee as default};
