import{at as C,j as e,T as m,c as L,r as x,aD as N,a as F,b as v,ba as A,S as f,I as z,e as M,h as E,o as R,k as y,s as G,bb as D,aw as W,B as k,aB as H}from"./index-BuLT-AS9.js";import{M as q}from"./ModalComponent-CNxH8GAn.js";const b=C(),Q=[b.accessor("id",{header:"ID"}),b.accessor("planName",{header:"Plan Name"}),b.accessor("createdAt",{header:"Date",Cell:({row:t})=>e.jsx(m,{children:new Date(t.original.createdAt).toLocaleString()})})],V=R({planName:G().trim().min(1,"Plan name is required").min(3,"Plan name must be at least 3 characters")});function J({onClose:t}){var S;const c=L(),n={planName:""},[r,s]=x.useState(""),{data:o,isLoading:u}=N({page:1,sizePerPage:5,search:r},{skip:r.length<2});r.length>=2&&(S=o==null?void 0:o.data)!=null&&S.groupsList;const{register:i,handleSubmit:p,reset:h,watch:P,setValue:g,formState:{errors:l}}=F({resolver:v(V),defaultValues:n}),[d,{isLoading:I}]=A(),w=async T=>{var j,B;try{const a=await d(T).unwrap();a!=null&&a.status&&(c(y({open:!0,message:a==null?void 0:a.message,severity:"success"})),h(n),t())}catch(a){(j=a==null?void 0:a.data)!=null&&j.status||c(y({open:!0,message:((B=a==null?void 0:a.data)==null?void 0:B.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return e.jsxs(e.Fragment,{children:[e.jsx(m,{sx:{fontSize:"2rem",fontWeight:"700",mb:"1.2rem"},children:"Add IB Plan"}),e.jsxs(f,{component:"form",onSubmit:p(w),children:[e.jsxs(f,{children:[e.jsx(z,{sx:{mb:".5rem"},children:"Plan Name *"}),e.jsx(M,{...i("planName",{required:!0}),size:"small",fullWidth:!0,placeholder:"Enter Plan Name",variant:"outlined"}),l.planName&&e.jsx(m,{color:"error",fontSize:"14px",children:l.planName.message})]}),e.jsx(E,{variant:"contained",type:"submit",disabled:I,sx:{textTransform:"capitalize",boxShadow:"none",color:"white",mt:"1.5rem",alignSelf:"self-start","&:hover":{boxShadow:"none"}},children:"Submit"})]})]})}function U(){var g,l,d;const[t,c]=x.useState({pageIndex:0,pageSize:10}),[n,r]=x.useState(""),{data:s,isLoading:o,isError:u,error:i}=D({page:t.pageIndex+1,sizePerPage:t.pageSize,search:n}),p=(g=i==null?void 0:i.data)==null?void 0:g.message,h=((l=s==null?void 0:s.data)==null?void 0:l.ibComissionNameList)||[],P=W({columns:Q,data:h,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,manualPagination:!0,manualFiltering:!0,rowCount:((d=s==null?void 0:s.data)==null?void 0:d.totalRecords)||0,state:{pagination:t,globalFilter:n,isLoading:o,showAlertBanner:u},onPaginationChange:c,onGlobalFilterChange:r,columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiToolbarAlertBannerProps:u?{color:"error",children:p||"Error loading IB Plan List."}:void 0});return e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"h5",fontWeight:"700",fontSize:"1.8rem",mb:"2rem",children:"IB Plan List"}),e.jsx(k,{display:"flex",justifyContent:"flex-end",children:e.jsx(q,{modalWidth:{xs:"90%",sm:600},btnName:"Add IB Plan",Content:J,btnSx:{color:"white",textTransform:"none"}})}),e.jsx(f,{sx:{marginTop:"2rem",borderRadius:"1.2rem",overflow:"hidden"},children:e.jsx(H,{table:P})})]})}export{U as default};
