import{c as T,r as p,cD as z,j as t,S as m,T as x,aI as b,h as k,i as v,av as I,Z as P,cE as D,ay as L,B as M,I as y,aD as A}from"./index-oaA_Ltxz.js";import{M as O}from"./ModalComponent-DTq5tozF.js";function w({data:e,onClose:s}){const c=T(),l=e==null?void 0:e.ticketId,n=e==null?void 0:e.currentStatus,[o,i]=p.useState(n||"");p.useEffect(()=>{i(n||"")},[n]);const[S,{isLoading:d}]=z(),h=async()=>{var u;try{const a=await S({ticketId:l,status:o}).unwrap();a!=null&&a.status&&(c(v({open:!0,message:a==null?void 0:a.message,severity:"success"})),s())}catch(a){c(v({open:!0,message:((u=a==null?void 0:a.data)==null?void 0:u.message)||"Failed to update status.",severity:"error"}))}};return t.jsxs(m,{spacing:2,children:[t.jsx(x,{variant:"h5",fontWeight:"700",fontSize:"1.5rem",children:"Update Status"}),t.jsx(b,{items:["OPEN","CLOSED","PROCESSING"],showDefaultOption:!1,value:o,disabled:d,onChange:u=>i(u.target.value)}),t.jsx(k,{variant:"contained",onClick:h,disabled:d||o===n,sx:{textTransform:"capitalize",boxShadow:"none",color:"white","&:hover":{boxShadow:"none"}},children:"Update Status"})]})}const r=I(),R=[r.accessor("subject",{header:"Subject"}),r.accessor("userId",{header:"User ID"}),r.display({id:"name",header:"Name",Cell:({row:e})=>{const s=e.original.user.name;return t.jsx(x,{children:s})},size:100}),r.display({id:"email",header:"Email",Cell:({row:e})=>{const s=e.original.user.email;return t.jsx(x,{children:s})},size:100}),r.accessor("status",{header:"Status"}),r.accessor("priority",{header:"Priority"}),r.accessor("createdAt",{header:"Date",Cell:({row:e})=>t.jsx(x,{children:new Date(e.original.createdAt).toLocaleString()})}),r.display({header:"Action",Cell:({row:e})=>{var l,n,o;const s=(l=e==null?void 0:e.original)==null?void 0:l.id,c=((n=e==null?void 0:e.original)==null?void 0:n.status)!=="CLOSED";return t.jsxs(m,{sx:{flexDirection:"row",gap:"10px"},children:[t.jsx(k,{variant:"contained",component:P,to:"/admin/tickets/showTicket",state:{ticketId:s},size:"small",sx:{textTransform:"capitalize",boxShadow:"none",color:"white","&:hover":{boxShadow:"none"}},children:"View"}),c&&t.jsx(O,{btnName:"Edit",Content:w,contentData:{currentStatus:(o=e==null?void 0:e.original)==null?void 0:o.status,ticketId:s},btnSx:{textTransform:"capitalize",boxShadow:"none",color:"white","&:hover":{boxShadow:"none"}}})]})},size:100})];function F(){var f,j,C;const[e,s]=p.useState({pageIndex:0,pageSize:10}),[c,l]=p.useState(""),[n,o]=p.useState(""),{data:i,isLoading:S,isError:d,error:h}=D({page:e.pageIndex+1,sizePerPage:e.pageSize,status:c,priority:n}),u=(f=h==null?void 0:h.data)==null?void 0:f.message,a=((j=i==null?void 0:i.data)==null?void 0:j.ticketList)||[],E=L({columns:R,data:a,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,manualPagination:!0,manualFiltering:!0,enableGlobalFilter:!1,rowCount:((C=i==null?void 0:i.data)==null?void 0:C.totalRecords)||0,state:{pagination:e,isLoading:S,showAlertBanner:d},onPaginationChange:s,columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiToolbarAlertBannerProps:d?{color:"error",children:u||"Error loading All tickets."}:void 0});return t.jsxs(t.Fragment,{children:[t.jsx(x,{variant:"h5",fontWeight:"700",fontSize:"1.8rem",mb:"2rem",children:"All tickets"}),t.jsxs(M,{sx:{display:"flex",gap:"15px"},children:[t.jsxs(m,{children:[t.jsx(y,{sx:{mb:.5,fontSize:12},children:"Status"}),t.jsx(b,{items:["OPEN","CLOSED","PROCESSING"],value:c,onChange:g=>l(g.target.value),width:{xs:"100%",sm:200}})]}),t.jsxs(m,{children:[t.jsx(y,{sx:{mb:.5,fontSize:12},children:"Priority"}),t.jsx(b,{items:["LOW","MEDIUM","HIGH"],value:n,onChange:g=>o(g.target.value),width:{xs:"100%",sm:200}})]})]}),t.jsx(m,{sx:{marginTop:"2rem",borderRadius:"1.2rem",overflow:"hidden"},children:t.jsx(A,{table:E})})]})}export{F as default};
