import{Q,j as e,at as K,X as S,T as h,$ as D,B as v,S as d,au as V,h as A,r as l,av as X,aw as _,ax as q,ay as J,I as y,az as Z,aA as P,aB as ee,e as ae}from"./index-B_S0l-pH.js";import{F as te}from"./FileDownload-BsKDBh15.js";import{d as U}from"./dayjs.min-CuTKjy4W.js";import{U as L}from"./UserAssignToModalDetails-9G3c2YVy.js";import{M as B}from"./ModalComponent-CkQKoq1J.js";import{S as se}from"./SearchableDropdown-BTGFcKz7.js";import{a as ne}from"./allCountryName-B6BN2SR9.js";import{A as oe}from"./AdapterDayjs-BVSUtSHg.js";import"./SearchableSelector-C9pLKMko.js";const re=Q(e.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m-2 14-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9z"}),"AssignmentTurnedIn"),ie=[{name:"Assign To",icon:re,modal:L},{name:"Edit",icon:V,link:"/admin/userManagement/editUser"}],c=K(),le=[c.accessor("userName",{header:"User name",Cell:({row:a})=>{var o;const{pathname:t}=S(),n=(o=a==null?void 0:a.original)==null?void 0:o.id;return e.jsx(h,{component:D,to:`/admin/userManagement/userDetails/summary/${n}`,state:{pathname:t},sx:{color:"inherit"},children:a.original.userName})}}),c.accessor("name",{header:"Name",Cell:({row:a})=>{var o;const{pathname:t}=S(),n=(o=a==null?void 0:a.original)==null?void 0:o.id;return e.jsx(h,{component:D,to:`/admin/userManagement/userDetails/summary/${n}`,state:{pathname:t},sx:{color:"inherit"},children:a.original.name})}}),c.accessor("email",{header:"Email"}),c.accessor("country",{header:"Country"}),c.display({id:"salesName",header:"Sales Name",Cell:({row:a})=>{var n,o;const t=(o=(n=a==null?void 0:a.original)==null?void 0:n.sales)==null?void 0:o.name;return e.jsx(h,{children:t})}}),c.display({id:"salesEmail",header:"Sales Email",Cell:({row:a})=>{var n,o;const t=(o=(n=a==null?void 0:a.original)==null?void 0:n.sales)==null?void 0:o.email;return e.jsx(h,{children:t})}}),c.accessor("createdAt",{header:"Registration Date",Cell:({row:a})=>e.jsx(h,{children:new Date(a.original.createdAt).toLocaleString()})}),c.accessor("isDeleted",{header:"Status",Cell:({row:a})=>{const t=a.original.isDeleted;return e.jsx(v,{component:"span",sx:{color:t?"error.main":"success.main",fontWeight:"bold"},children:t?"Inactive":"Active"})}}),c.display({id:"action",header:"Action",Cell:({row:a})=>e.jsx(d,{sx:{flexDirection:"row",gap:"4px",flexWrap:"wrap"},children:ie.map((t,n)=>{var x,g;t.icon;const o=(x=a==null?void 0:a.original)==null?void 0:x.id;(g=a==null?void 0:a.original)==null||g.name;const p=(t==null?void 0:t.link)&&(t==null?void 0:t.link),{pathname:b}=S();return p?e.jsx(A,{component:D,to:p,state:{pathname:b,userId:o},sx:{color:"white",minWidth:"1.5rem",fontSize:"0.7rem",px:"8px",py:"4px"},variant:"contained",children:t.name},n):e.jsx(B,{Content:L,btnName:t.name,contentData:o,modalWidth:{xs:"95%",sm:600},btnSx:{color:"white",minWidth:"1.5rem",fontSize:"0.7rem",px:"8px",py:"4px"}},n)})})})];function be(){var R,z,N;const[a,t]=l.useState(""),[n,o]=l.useState({pageIndex:0,pageSize:10}),[p,b]=l.useState(""),[x,g]=l.useState(""),[T,I]=l.useState(""),[f,E]=l.useState(!1),[u,W]=l.useState({fromDate:null,toDate:null}),Y=u.fromDate?U(u.fromDate).format("YYYY-MM-DD"):void 0,w=u.toDate?U(u.toDate).format("YYYY-MM-DD"):void 0,{data:i,isFetching:G,isError:M,error:j}=X({page:n.pageIndex+1,sizePerPage:n.pageSize,search:p,isIb:T,fromDate:Y,toDate:w,country:x,fileExport:f});l.useEffect(()=>{if(f&&i instanceof Blob){const s=window.URL.createObjectURL(i),r=document.createElement("a");r.href=s,r.download="userList.xlsx",document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(s),E(!1)}},[f,i]);const H=(R=j==null?void 0:j.data)==null?void 0:R.message,$=i instanceof Blob?[]:((z=i==null?void 0:i.data)==null?void 0:z.usersList)||[],C=i instanceof Blob?0:((N=i==null?void 0:i.data)==null?void 0:N.totalRecords)||0,k=_({columns:le,data:$,enableRowSelection:!0,enableSelectAll:!0,getRowId:s=>s._id,manualPagination:!0,manualFiltering:!0,rowCount:C,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,state:{pagination:n,globalFilter:p,isLoading:G,showAlertBanner:M},initialState:{showGlobalFilter:!0},onPaginationChange:o,onGlobalFilterChange:b,paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiToolbarAlertBannerProps:M?{color:"error",children:H||"Error loading User List"}:void 0,renderTopToolbarCustomActions:()=>{const r=k.getSelectedRowModel().rows.map(m=>Number(m.original.id));return e.jsxs(v,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap",p:1},children:[e.jsx(A,{variant:"contained",startIcon:e.jsx(te,{}),onClick:()=>E(!0),disabled:f,sx:{textTransform:"none"},children:"Excel"}),r.length>0&&e.jsx(B,{Content:L,btnName:`Assign To (${r.length})`,contentData:r,modalWidth:{xs:"95%",sm:600}})]})},renderBottomToolbarCustomActions:()=>e.jsxs(d,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(ae,{size:"small",type:"number",placeholder:"Page no",value:a,onChange:s=>t(s.target.value),onKeyDown:s=>{if(s.key==="Enter"){const r=Number(a),m=Math.ceil(C/n.pageSize);r>=1&&r<=m&&o(O=>({...O,pageIndex:r-1}))}}}),e.jsx(A,{variant:"contained",sx:{textTransform:"none"},onClick:()=>{const s=Number(a),r=Math.ceil(C/n.pageSize);s>=1&&s<=r&&o(m=>({...m,pageIndex:s-1}))},children:"Go"})]})}),F=l.useCallback((s,r)=>{W(m=>({...m,[s]:r}))},[]);return e.jsxs(d,{children:[e.jsx(h,{variant:"h5",fontWeight:700,mb:2,children:"User List"}),e.jsx(v,{children:e.jsx(q,{control:e.jsx(J,{checked:T===!0,onChange:s=>I(s.target.checked?!0:"")}),label:"IB Users"})}),e.jsxs(d,{direction:"row",spacing:2,mt:2,flexWrap:"wrap",children:[e.jsxs(d,{children:[e.jsx(y,{sx:{fontSize:12},children:"Search with country"}),e.jsx(se,{options:ne,value:x,onChange:g,placeholder:"Select Country",width:"250px"})]}),e.jsx(Z,{dateAdapter:oe,children:e.jsxs(d,{direction:"row",spacing:2,children:[e.jsxs(d,{children:[e.jsx(y,{sx:{fontSize:12},children:"From"}),e.jsx(P,{value:u.fromDate,onChange:s=>F("fromDate",s),slotProps:{textField:{size:"small"}}})]}),e.jsxs(d,{children:[e.jsx(y,{sx:{fontSize:12},children:"To"}),e.jsx(P,{value:u.toDate,onChange:s=>F("toDate",s),slotProps:{textField:{size:"small"}}})]})]})})]}),e.jsx(d,{mt:3,sx:{borderRadius:"1.2rem",overflow:"hidden"},children:e.jsx(ee,{table:k})})]})}export{be as default};
