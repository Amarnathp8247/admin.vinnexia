import{o as w,aC as L,c as v,r as A,b7 as z,a as B,b as D,bl as q,j as a,S as C,T as u,B as F,I as P,h as U,k as h}from"./index-Bjlp2vES.js";import{S as V}from"./SearchableSelector-C6ndV5ZN.js";const E=w({marketingMemberId:L({required_error:"Marketing member is required"}).nullable().refine(n=>n!==null,{message:"Marketing member is required"})});function Q({data:n,onClose:b}){var g;const r=n,m=v(),[i,M]=A.useState(""),l={marketingMemberId:null},{data:o,isLoading:p}=z({page:1,sizePerPage:10,search:i},{skip:i.length<3}),k=i.length>=3?((g=o==null?void 0:o.data)==null?void 0:g.usersList)||[]:[],{handleSubmit:x,reset:S,watch:f,setValue:y,formState:{errors:c}}=B({resolver:D(E),defaultValues:l}),[j,{isLoading:T}]=q(),I=async e=>{var d;try{const t={marketingMemberId:e.marketingMemberId,userIds:r},s=await j(t).unwrap();s!=null&&s.status&&(m(h({open:!0,message:s==null?void 0:s.message,severity:"success"})),S(l),b())}catch(t){m(h({open:!0,message:((d=t==null?void 0:t.data)==null?void 0:d.message)||"Failed to assign users. Please try again.",severity:"error"}))}};return a.jsxs(C,{component:"form",onSubmit:x(I),children:[a.jsxs(u,{fontWeight:700,fontSize:"1.5rem",mb:"1.5rem",children:["Assign To (",r==null?void 0:r.length,")"]}),a.jsxs(F,{children:[a.jsx(P,{sx:{mb:".5rem"},children:"Select Marketing *"}),a.jsx(V,{width:"100%",items:k.map(e=>({value:e.id,name:`${e.name} (${e.email})`})),value:f("marketingMemberId"),onChange:e=>y("marketingMemberId",e,{shouldValidate:!0}),onSearchChange:e=>M(e),isLoading:p,shouldBeFullwidth:!0}),c.marketingMemberId&&a.jsx(u,{color:"error",fontSize:"14px",children:c.marketingMemberId.message})]}),a.jsx(U,{type:"submit",variant:"contained",disabled:T,sx:{textTransform:"capitalize",boxShadow:"none",color:"white",mt:"1.5rem",alignSelf:"flex-start","&:hover":{boxShadow:"none"}},children:"Assign"})]})}export{Q as U};
