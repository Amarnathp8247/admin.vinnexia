import{at as g,j as a,T as u,a$ as C,a4 as T,X as S,r as c,aw as P,S as p,B as h,aB as k,h as y}from"./index-B_S0l-pH.js";import{F as j}from"./FileDownload-BsKDBh15.js";import{u as d,w as z}from"./xlsx-D1NZSDnX.js";import"./editDocumentSchema-BKTN6qT0.js";const s=g(),A=[s.accessor("Position",{header:"Position",size:40}),s.accessor("Login",{header:"Log in",size:40}),s.accessor("Symbol",{header:"Symbol",size:100}),s.accessor("Action",{header:"Action",size:100,Cell:({row:e})=>{var t;const o=(t=e==null?void 0:e.original)==null?void 0:t.Action;return a.jsx(u,{sx:{color:o==1?"red":"green"},children:o==1?"Sell":"Buy"})}}),s.accessor("PriceOpen",{header:"Open price",size:100}),s.accessor("PriceCurrent",{header:"Current price",size:100}),s.accessor("PriceSL",{header:"SL price",size:100}),s.accessor("PriceTP",{header:"TP price",size:100}),s.accessor("Volume",{header:"Volume",size:100,Cell:({row:e})=>{var t;const o=(t=e==null?void 0:e.original)==null?void 0:t.Volume;return a.jsx(u,{children:o/1e4})}}),s.accessor("Profit",{header:"Profit",size:100}),s.accessor("TimeCreate",{header:"Created AT",size:200,Cell:({row:e})=>{const o=e.original.TimeCreate,n=new Date(o*1e3).toLocaleString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(",","");return a.jsx(u,{children:n})}})];function F({token:e,login:o,handlePositionData:t}){const n=C("https://backend.boostbullion.com",{autoConnect:!1,extraHeaders:{authorization:e}});return n.connect(),n.on("connect",()=>{o&&n.emit("checkPosition",{login:o})}),n.on("checkPosition",i=>{i&&t(i)}),n}const w=e=>{const o=d.json_to_sheet(e),t=d.book_new();d.book_append_sheet(t,o,"Sheet1"),z(t,"userList.xlsx")};function B(){const{token:e}=T(l=>l.auth),{state:o}=S(),t=o==null?void 0:o.logIn,[n,i]=c.useState(null);let r=c.useRef(null);c.useEffect(()=>{if(!(!t||!e))return r.current&&(r.current.disconnect(),i(null)),r.current=F({login:t,token:e,handlePositionData:m}),()=>{r.current&&r.current.disconnect()}},[t,e]);const m=l=>{i(l)},[x,f]=c.useState(""),b=P({columns:A||[],data:Array.isArray(n)?n:[],enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,manualFiltering:!0,state:{globalFilter:x,isLoading:!n},initialState:{showGlobalFilter:!0},onGlobalFilterChange:f,columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",renderTopToolbarCustomActions:()=>a.jsx(h,{sx:{display:"flex",gap:"16px",padding:"8px",flexWrap:"wrap"},children:a.jsx(y,{variant:"contained",onClick:()=>w(n),startIcon:a.jsx(j,{sx:{color:"white"}}),sx:{textTransform:"none",color:"white",boxShadow:"none","&:hover":{boxShadow:"none"}},children:"Excel"})})});return a.jsxs(p,{children:[a.jsx(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"}}),a.jsx(p,{sx:{marginTop:"2rem",borderRadius:"1.8rem",overflow:"hidden"},children:a.jsx(k,{table:b})})]})}export{B as default};
