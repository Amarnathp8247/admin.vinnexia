import{Q as E,j as a,at as H,X as I,T as x,$ as v,n as P,r as S,av as A,aV as F,aw as M,ak as z,B as b,S as R,I as B,aB as D,h as $}from"./index-DcG3qw6T.js";import{F as _}from"./FileDownload-rr-bL3sD.js";import{S as W}from"./SearchableSelector-BYsl9Yx6.js";import{u as f,w as Q}from"./xlsx-D1NZSDnX.js";import{A as V}from"./Avatar-DMY7JyDQ.js";const G=E(a.jsx("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"History"),u=H(),N=[u.display({id:"name",header:"Name",size:40,Cell:({row:e})=>{var n,i,o,d,r,m,p,s,g,l;const{pathname:t}=I(),c=(i=(n=e==null?void 0:e.original)==null?void 0:n.user)==null?void 0:i.id;return a.jsx(x,{component:(d=(o=e==null?void 0:e.original)==null?void 0:o.user)!=null&&d.name?v:"em",to:`/admin/userManagement/userDetails/summary/${c}`,state:{pathname:t},sx:{fontSize:!((m=(r=e==null?void 0:e.original)==null?void 0:r.user)!=null&&m.name)&&".7rem",color:"inherit"},children:(s=(p=e==null?void 0:e.original)==null?void 0:p.user)!=null&&s.name?(l=(g=e==null?void 0:e.original)==null?void 0:g.user)==null?void 0:l.name:"Empty"})}}),u.display({id:"email",header:"Email",size:40,Cell:({row:e})=>{var n,i,o,d,r,m,p,s,g,l;const{pathname:t}=I(),c=(i=(n=e==null?void 0:e.original)==null?void 0:n.user)==null?void 0:i.id;return a.jsx(x,{component:(d=(o=e==null?void 0:e.original)==null?void 0:o.user)!=null&&d.email?v:"em",to:`/admin/userManagement/userDetails/summary/${c}`,state:{pathname:t},sx:{fontSize:!((m=(r=e==null?void 0:e.original)==null?void 0:r.user)!=null&&m.email)&&".7rem",color:"inherit"},children:(s=(p=e==null?void 0:e.original)==null?void 0:p.user)!=null&&s.email?(l=(g=e==null?void 0:e.original)==null?void 0:g.user)==null?void 0:l.email:"Empty"})}}),u.accessor("ipAddress",{header:"IP Address",size:40}),u.accessor("device",{header:"Device",size:40}),u.accessor("timestamp",{header:"Login At",size:40,Cell:({row:e})=>a.jsx(x,{children:new Date(e.original.timestamp).toLocaleString()})})],U=e=>{const t=e.map(i=>i.original),c=f.json_to_sheet(t),n=f.book_new();f.book_append_sheet(n,c,"Sheet1"),Q(n,"logInHistoryList.xlsx")};function Y(){var L,C;const e=P(),[t,c]=S.useState({pageIndex:0,pageSize:10}),[n,i]=S.useState(""),[o,d]=S.useState(""),{data:r,isLoading:m}=A({page:1,sizePerPage:5,search:o},{skip:o.length<3}),p=o.length>=3?((L=r==null?void 0:r.data)==null?void 0:L.usersList)||[]:[],{data:s,isLoading:g,isError:l,error:y}=F({page:t.pageIndex+1,sizePerPage:t.pageSize,userId:n}),T=(C=y==null?void 0:y.data)==null?void 0:C.message,j=(s==null?void 0:s.data)||[],k=M({columns:N,data:j,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,enableGlobalFilter:!1,manualPagination:!0,manualFiltering:!0,rowCount:(s==null?void 0:s.totalRecords)||0,state:{pagination:t,isLoading:g,showAlertBanner:l},onPaginationChange:c,columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiToolbarAlertBannerProps:l?{color:"error",children:T||"Error loading Login history List."}:void 0,renderTopToolbarCustomActions:()=>a.jsx(b,{sx:{display:"flex",gap:"16px",padding:"8px",flexWrap:"wrap"},children:a.jsx($,{variant:"contained",onClick:()=>U(j),startIcon:a.jsx(_,{sx:{color:"white"}}),sx:{textTransform:"none",color:"white",boxShadow:"none",borderRadius:"8px",bgcolor:e.palette.primary.main,"&:hover":{bgcolor:e.palette.primary.dark,boxShadow:e.shadows[2]}},children:"Excel"})}),muiTablePaperProps:{elevation:0,sx:{borderRadius:"16px",border:`1px solid ${z(e.palette.divider,.1)}`}}});return a.jsxs(a.Fragment,{children:[a.jsxs(b,{display:"flex",alignItems:"center",gap:2,mb:3,children:[a.jsx(V,{sx:{bgcolor:z(e.palette.secondary.main,.1),color:e.palette.secondary.main},children:a.jsx(G,{})}),a.jsx(x,{variant:"h6",fontWeight:700,children:"Login History"})]}),a.jsx(R,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"flex-end",mb:3,children:a.jsxs(b,{flex:1,maxWidth:"400px",children:[a.jsx(B,{sx:{mb:1,fontSize:"14px",fontWeight:600},children:"Select Client"}),a.jsx(W,{width:"100%",items:p.map(h=>({value:h.id,name:`${h.name} (${h.email})`})),value:n,onChange:h=>i(h),onSearchChange:h=>d(h),isLoading:m}),a.jsx(x,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:"Enter 3+ characters to search"})]})}),a.jsx(b,{sx:{borderRadius:"16px",overflow:"hidden"},children:a.jsx(D,{table:k})})]})}export{Y as default};
