import{o as D,s as E,aC as S,c as U,a4 as W,r as L,av as _,aD as Q,a as R,aE as Z,j as e,S as N,T as i,aF as O,G as o,I as n,aG as H,e as J,h as K,b as X,k as z}from"./index-B_S0l-pH.js";import{S as C}from"./SearchableSelector-C9pLKMko.js";import{C as Y}from"./Card-BbyUSaIa.js";const ee=D({userId:S({required_error:"Client is required"}).nullable().refine(a=>a!==null,{message:"Client is required"}),groupId:S({required_error:"Client is required"}).nullable().refine(a=>a!==null,{message:"Client is required"}),Leverage:S().min(1,"Leverage is required"),PassMain:E().min(8,"Main password must be at least 8 characters").refine(a=>/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[!@#$%^&*])[A-Za-z\d!@#$%^&*]{8,}$/.test(a),{message:"Main password must include at least one uppercase letter, one lowercase letter, one number, and one special character (!@#$%^&*)"})});function te(){var b,j;const a=U(),{selectedTheme:w}=W(s=>s.themeMode),[c,y]=L.useState(""),[m,M]=L.useState(""),{data:h,isLoading:P}=_({page:1,sizePerPage:10,search:c},{skip:c.length<3}),{data:g,isLoading:I}=Q({page:1,sizePerPage:10,search:m},{skip:m.length<2}),T=c.length>=3?((b=h==null?void 0:h.data)==null?void 0:b.usersList)||[]:[],l=m.length>=2?((j=g==null?void 0:g.data)==null?void 0:j.groupsList)||[]:[],f={userId:null,groupId:null,Leverage:0,PassMain:""},{register:q,handleSubmit:F,reset:A,watch:d,setValue:x,formState:{errors:t}}=R({resolver:X(ee),defaultValues:f}),p=l==null?void 0:l.find(s=>s.id==d("groupId")),G=(p==null?void 0:p.leverage)/100||0;let $=Array.from({length:G},(s,u)=>100*(u+1));const[k,{isLoading:V}]=Z(),B=async s=>{var u,v;try{const r=await k(s).unwrap();r!=null&&r.status&&(a(z({open:!0,message:r==null?void 0:r.message,severity:"success"})),A(f))}catch(r){(u=r==null?void 0:r.data)!=null&&u.status||a(z({open:!0,message:((v=r==null?void 0:r.data)==null?void 0:v.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return e.jsxs(N,{children:[e.jsx(i,{sx:{fontSize:"2rem",fontWeight:"700",mb:"2rem"},children:"Create MT5 Account"}),e.jsxs(Y,{sx:{boxShadow:"0 0px 0px 0 rgba(0, 0, 0, 0.19), 0 0px 8px 0 rgba(0, 0, 0, 0.19)",borderRadius:"1.2rem",padding:{xs:"1rem",md:"2rem"},bgcolor:w==="dark"&&"#272727"},component:"form",onSubmit:F(B),children:[e.jsx(i,{mx:{xs:"1rem",md:"0"},children:"Fill Details"}),e.jsx(O,{sx:{my:"1.2rem"}}),e.jsxs(o,{container:!0,size:12,spacing:2,children:[e.jsxs(o,{size:{xs:12,sm:6,md:4},children:[e.jsx(n,{sx:{mb:".5rem"},children:"Select Client *"}),e.jsx(C,{width:"100%",items:T.map(s=>({value:s.id,name:`${s.name} (${s.email})`})),value:d("userId"),onChange:s=>x("userId",s,{shouldValidate:!0}),onSearchChange:s=>y(s),isLoading:P,shouldBeFullwidth:!0}),e.jsx(n,{sx:{fontSize:"12px"},children:"Please enter 3 or more characters"}),t.userId&&e.jsx(i,{color:"error",fontSize:"14px",children:t.userId.message})]}),e.jsxs(o,{size:{xs:12,sm:6,md:4},children:[e.jsx(n,{sx:{mb:".5rem"},children:"Select Group *"}),e.jsx(C,{width:"100%",items:l.map(s=>({value:s.id,name:s.name})),value:d("groupId"),onChange:s=>x("groupId",s,{shouldValidate:!0}),onSearchChange:s=>M(s),isLoading:I,shouldBeFullwidth:!0}),t.group&&e.jsx(i,{color:"error",fontSize:"14px",children:t.group.message})]}),e.jsxs(o,{size:{xs:12,sm:6,md:4},children:[e.jsx(n,{sx:{mb:".5rem"},children:"Select Leverage *"}),e.jsx(H,{value:d("Leverage"),items:$,onChange:s=>x("Leverage",s.target.value,{shouldValidate:!0}),shouldBeFullWidth:!0}),e.jsx(n,{sx:{fontSize:"12px"},children:"Please select group first"}),t.Leverage&&e.jsx(i,{color:"error",fontSize:"14px",children:t.Leverage.message})]}),e.jsxs(o,{size:{xs:12,sm:6,md:4},children:[e.jsx(n,{sx:{mb:".5rem"},children:"Main Password *"}),e.jsx(J,{...q("PassMain",{required:!0}),size:"small",fullWidth:!0,placeholder:"Please type main password..."}),t.PassMain&&e.jsx(i,{color:"error",fontSize:"14px",children:t.PassMain.message})]})]}),e.jsx(K,{type:"submit",variant:"contained",disabled:V,sx:{textTransform:"capitalize",boxShadow:"none",color:"white",mt:"1.5rem",alignSelf:"self-start","&:hover":{boxShadow:"none"}},children:"Submit"})]})]})}export{te as default};
